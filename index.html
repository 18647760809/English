<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>移动英语学习工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e6f7ff 0%, #f0f9ff 100%);
            color: #2c3e50;
            min-height: 100vh;
            padding: 15px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            padding-bottom: 80px;
        }
        
        header {
            background: #3498db;
            color: white;
            padding: 20px 15px;
            position: relative;
            text-align: center;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-weight: 600;
        }
        
        h1 i {
            font-size: 28px;
        }
        
        .subtitle {
            font-size: 14px;
            opacity: 0.9;
            max-width: 90%;
            margin: 0 auto;
        }
        
        .input-section {
            padding: 20px 15px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .section-title {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #3498db;
            font-weight: 600;
        }
        
        .section-title i {
            font-size: 20px;
        }
        
        textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 1px solid #d0e3f1;
            border-radius: 15px;
            font-size: 16px;
            resize: none;
            outline: none;
            transition: all 0.3s;
            background: #f9fbfd;
        }
        
        textarea:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .btn-container {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn {
            flex: 1;
            padding: 14px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
        }
        
        .btn-secondary {
            background: #f1f5f9;
            color: #2c3e50;
        }
        
        .btn-secondary:hover {
            background: #e5ebf1;
        }
        
        .output-section {
            padding: 20px 15px;
        }
        
        .lang-toggle {
            display: flex;
            background: #f1f5f9;
            border-radius: 50px;
            padding: 5px;
            margin: 15px 0;
        }
        
        .lang-option {
            flex: 1;
            padding: 10px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .lang-option.active {
            background: #3498db;
            color: white;
        }
        
        .transcript-container {
            height: 220px;
            overflow-y: auto;
            padding: 10px;
            background: white;
            border-radius: 15px;
            border: 1px solid #e0e6ed;
            margin-bottom: 15px;
        }
        
        .transcript-line {
            padding: 14px;
            border-radius: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            border-left: 3px solid transparent;
        }
        
        .transcript-line:hover {
            background: #f8fafd;
        }
        
        .transcript-line.active {
            background: rgba(52, 152, 219, 0.08);
            border-left: 3px solid #3498db;
        }
        
        .transcript-line .text {
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .transcript-line .chinese {
            font-size: 14px;
            color: #5a6b82;
            font-style: italic;
            padding-top: 8px;
            border-top: 1px dashed #eaeaea;
        }
        
        .controls-container {
            background: white;
            border-radius: 15px;
            padding: 20px 15px;
            margin-top: 15px;
            border: 1px solid #e0e6ed;
        }
        
        .controls-header {
            text-align: center;
            margin-bottom: 20px;
            color: #3498db;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .speed-control {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .speed-label {
            font-size: 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .speed-label i {
            color: #3498db;
            font-size: 20px;
        }
        
        .speed-buttons {
            display: flex;
            gap: 8px;
        }
        
        .speed-btn {
            padding: 10px 15px;
            border-radius: 30px;
            border: 1px solid #3498db;
            background: white;
            color: #3498db;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .speed-btn.active {
            background: #3498db;
            color: white;
        }
        
        .playback-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .func-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #f1f5f9;
            color: #3498db;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            font-size: 20px;
        }
        
        .func-btn.active {
            background: #3498db;
            color: white;
        }
        
        .play-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: #3498db;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
            border: none;
            font-size: 24px;
        }
        
        .play-btn:hover {
            transform: scale(1.05);
        }
        
        .point-read-btn {
            display: block;
            width: 100%;
            padding: 14px;
            border-radius: 15px;
            background: #f1f5f9;
            color: #2c3e50;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .point-read-btn.active {
            background: #2ecc71;
            color: white;
        }
        
        .status-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #3498db;
            color: white;
            padding: 12px 15px;
            text-align: center;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-item i {
            font-size: 16px;
        }
        
        .compatibility-warning {
            background: #fff8e6;
            border: 1px solid #ffd166;
            border-radius: 12px;
            padding: 12px;
            margin: 15px 0;
            font-size: 14px;
            color: #5a6b82;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .compatibility-warning i {
            color: #ff9f1c;
            font-size: 20px;
            margin-top: 2px;
        }
        
        @media (min-width: 768px) {
            .container {
                max-width: 600px;
                margin: 20px auto;
            }
            
            body {
                padding: 20px;
                background: linear-gradient(135deg, #d4edff 0%, #e8f4ff 100%);
            }
            
            .transcript-container {
                height: 280px;
            }
        }
        
        @media (max-width: 480px) {
            .speed-buttons {
                flex-wrap: wrap;
                justify-content: flex-end;
            }
            
            .speed-btn {
                padding: 8px 12px;
                font-size: 13px;
            }
            
            .func-btn {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }
            
            .play-btn {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-language"></i> 移动英语学习工具</h1>
            <p class="subtitle">输入英文文本，自动翻译，支持点读、复读和倍速播放</p>
        </header>
        
        <div class="input-section">
            <div class="section-title">
                <i class="fas fa-keyboard"></i> 输入英文文本
            </div>
            
            <textarea id="englishInput" placeholder="在此粘贴或输入英文文本...">Hello! Learning English can be fun and rewarding. With consistent practice, you'll see improvement over time. Don't be afraid to make mistakes - they're part of the learning process. Try to immerse yourself in the language as much as possible. Listen to podcasts, watch movies, and practice speaking with native speakers whenever you can. Remember, every expert was once a beginner. Keep going and you'll achieve your goals!</textarea>
            
            <div class="btn-container">
                <button class="btn btn-primary" id="translateBtn">
                    <i class="fas fa-exchange-alt"></i> 翻译文本
                </button>
                <button class="btn btn-secondary" id="clearBtn">
                    <i class="fas fa-eraser"></i> 清空
                </button>
            </div>
        </div>
        
        <div class="output-section">
            <div class="lang-toggle">
                <div class="lang-option active" data-lang="both">中英对照</div>
                <div class="lang-option" data-lang="en">仅英文</div>
                <div class="lang-option" data-lang="cn">仅中文</div>
            </div>
            
            <div class="transcript-container" id="transcriptContainer">
                <div class="transcript-line" data-index="0">
                    <div class="text">Hello! Learning English can be fun and rewarding.</div>
                    <div class="chinese">你好！学习英语可以是有趣且有回报的。</div>
                </div>
                <div class="transcript-line" data-index="1">
                    <div class="text">With consistent practice, you'll see improvement over time.</div>
                    <div class="chinese">通过持续的练习，你会随着时间的推移看到进步。</div>
                </div>
                <div class="transcript-line" data-index="2">
                    <div class="text">Don't be afraid to make mistakes - they're part of the learning process.</div>
                    <div class="chinese">不要害怕犯错——它们是学习过程的一部分。</div>
                </div>
                <div class="transcript-line" data-index="3">
                    <div class="text">Try to immerse yourself in the language as much as possible.</div>
                    <div class="chinese">试着尽可能多地沉浸在语言中。</div>
                </div>
                <div class="transcript-line" data-index="4">
                    <div class="text">Listen to podcasts, watch movies, and practice speaking with native speakers whenever you can.</div>
                    <div class="chinese">听播客、看电影，并尽可能多地与母语者练习口语。</div>
                </div>
                <div class="transcript-line" data-index="5">
                    <div class="text">Remember, every expert was once a beginner.</div>
                    <div class="chinese">记住，每个专家都曾经是初学者。</div>
                </div>
                <div class="transcript-line" data-index="6">
                    <div class="text">Keep going and you'll achieve your goals!</div>
                    <div class="chinese">继续前进，你会实现你的目标！</div>
                </div>
            </div>
            
            <div class="compatibility-warning" id="compatibilityWarning">
                <i class="fas fa-info-circle"></i>
                <div>提示：朗读功能需要浏览器支持。如果无法使用，请尝试在Chrome或Safari浏览器中打开。</div>
            </div>
            
            <div class="controls-container">
                <div class="controls-header">
                    <i class="fas fa-sliders-h"></i> 学习控制面板
                </div>
                
                <div class="speed-control">
                    <div class="speed-label">
                        <i class="fas fa-tachometer-alt"></i> 播放速度
                    </div>
                    <div class="speed-buttons">
                        <button class="speed-btn" data-speed="0.5">0.5x</button>
                        <button class="speed-btn" data-speed="0.8">0.8x</button>
                        <button class="speed-btn active" data-speed="1.0">1.0x</button>
                        <button class="speed-btn" data-speed="1.2">1.2x</button>
                        <button class="speed-btn" data-speed="1.5">1.5x</button>
                    </div>
                </div>
                
                <button class="point-read-btn" id="pointReadBtn">
                    <i class="fas fa-hand-pointer"></i> 点读模式：点击句子单独播放
                </button>
                
                <div class="playback-controls">
                    <button class="func-btn" id="repeatBtn" title="复读">
                        <i class="fas fa-redo"></i>
                    </button>
                    <button class="func-btn" id="prevBtn" title="上一句">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="play-btn" id="playBtn">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="func-btn" id="nextBtn" title="下一句">
                        <i class="fas fa-step-forward"></i>
                    </button>
                    <button class="func-btn" id="loopBtn" title="循环播放">
                        <i class="fas fa-infinity"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="status-bar">
        <div class="status-item">
            <i class="fas fa-volume-up"></i>
            <span id="statusText">准备就绪</span>
        </div>
        <div class="status-item">
            <i class="fas fa-bolt"></i>
            <span>速度: <span id="speedText">1.0x</span></span>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 元素引用
            const englishInput = document.getElementById('englishInput');
            const translateBtn = document.getElementById('translateBtn');
            const clearBtn = document.getElementById('clearBtn');
            const transcriptContainer = document.getElementById('transcriptContainer');
            const langOptions = document.querySelectorAll('.lang-option');
            const speedBtns = document.querySelectorAll('.speed-btn');
            const pointReadBtn = document.getElementById('pointReadBtn');
            const playBtn = document.getElementById('playBtn');
            const repeatBtn = document.getElementById('repeatBtn');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const loopBtn = document.getElementById('loopBtn');
            const statusText = document.getElementById('statusText');
            const speedText = document.getElementById('speedText');
            const compatibilityWarning = document.getElementById('compatibilityWarning');
            
            // 当前状态
            let currentLang = 'both';
            let currentSpeed = 1.0;
            let pointReadEnabled = true;
            let isPlaying = false;
            let isLooping = false;
            let currentLineIndex = 0;
            let speechSynthesis = window.speechSynthesis;
            let voices = [];
            
            // 检测浏览器兼容性
            if (!speechSynthesis) {
                compatibilityWarning.style.display = 'flex';
                statusText.textContent = "您的浏览器不支持语音功能";
            } else {
                compatibilityWarning.style.display = 'none';
                
                // 加载可用语音
                speechSynthesis.onvoiceschanged = function() {
                    voices = speechSynthesis.getVoices();
                };
            }
            
            // 翻译功能（模拟）
            translateBtn.addEventListener('click', function() {
                const englishText = englishInput.value.trim();
                if (!englishText) {
                    updateStatus("请输入英文文本");
                    return;
                }
                
                // 模拟翻译 - 实际应用中应替换为真实翻译API
                const sentences = englishText.split(/(?<=[.!?])\s+/);
                let transcriptHTML = '';
                
                // 示例翻译
                const translations = [
                    "你好！学习英语可以是有趣且有回报的。",
                    "通过持续的练习，你会随着时间的推移看到进步。",
                    "不要害怕犯错——它们是学习过程的一部分。",
                    "试着尽可能多地沉浸在语言中。",
                    "听播客、看电影，并尽可能多地与母语者练习口语。",
                    "记住，每个专家都曾经是初学者。",
                    "继续前进，你会实现你的目标！"
                ];
                
                sentences.forEach((sentence, index) => {
                    const translation = translations[index] || "（翻译文本）";
                    transcriptHTML += `
                        <div class="transcript-line" data-index="${index}">
                            <div class="text">${sentence}</div>
                            <div class="chinese">${translation}</div>
                        </div>
                    `;
                });
                
                transcriptContainer.innerHTML = transcriptHTML;
                updateStatus("文本已翻译");
                
                // 重新绑定事件
                bindTranscriptEvents();
            });
            
            // 清空功能
            clearBtn.addEventListener('click', function() {
                englishInput.value = '';
                transcriptContainer.innerHTML = '<div class="transcript-line"><div class="text">翻译内容将显示在这里...</div></div>';
                updateStatus("内容已清空");
            });
            
            // 语言切换
            langOptions.forEach(option => {
                option.addEventListener('click', function() {
                    langOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    currentLang = this.dataset.lang;
                    updateLanguageDisplay();
                });
            });
            
            // 更新语言显示
            function updateLanguageDisplay() {
                const transcriptLines = document.querySelectorAll('.transcript-line');
                transcriptLines.forEach(line => {
                    const text = line.querySelector('.text');
                    const chinese = line.querySelector('.chinese');
                    
                    if (currentLang === 'en') {
                        if (chinese) chinese.style.display = 'none';
                        if (text) text.style.display = 'block';
                    } else if (currentLang === 'cn') {
                        if (text) text.style.display = 'none';
                        if (chinese) chinese.style.display = 'block';
                    } else {
                        if (text) text.style.display = 'block';
                        if (chinese) chinese.style.display = 'block';
                    }
                });
            }
            
            // 倍速控制
            speedBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    speedBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentSpeed = parseFloat(this.dataset.speed);
                    speedText.textContent = currentSpeed + "x";
                    updateStatus("速度设置为 " + currentSpeed + "x");
                });
            });
            
            // 点读模式切换
            pointReadBtn.addEventListener('click', function() {
                pointReadEnabled = !pointReadEnabled;
                if (pointReadEnabled) {
                    this.classList.add('active');
                    updateStatus("点读模式已启用");
                } else {
                    this.classList.remove('active');
                    updateStatus("点读模式已禁用");
                }
            });
            
            // 绑定文本点击事件
            function bindTranscriptEvents() {
                const transcriptLines = document.querySelectorAll('.transcript-line');
                transcriptLines.forEach((line, index) => {
                    line.dataset.index = index;
                    line.addEventListener('click', function() {
                        if (pointReadEnabled) {
                            currentLineIndex = index;
                            highlightCurrentLine();
                            speakCurrentLine();
                        }
                    });
                });
            }
            
            // 播放控制
            playBtn.addEventListener('click', function() {
                if (!speechSynthesis) {
                    updateStatus("您的浏览器不支持语音功能");
                    return;
                }
                
                isPlaying = !isPlaying;
                const icon = playBtn.querySelector('i');
                
                if (isPlaying) {
                    icon.classList.remove('fa-play');
                    icon.classList.add('fa-pause');
                    speakCurrentLine();
                } else {
                    icon.classList.remove('fa-pause');
                    icon.classList.add('fa-play');
                    speechSynthesis.cancel();
                    updateStatus("播放已停止");
                }
            });
            
            // 高亮当前行
            function highlightCurrentLine() {
                const transcriptLines = document.querySelectorAll('.transcript-line');
                transcriptLines.forEach(line => line.classList.remove('active'));
                if (transcriptLines[currentLineIndex]) {
                    transcriptLines[currentLineIndex].classList.add('active');
                    transcriptLines[currentLineIndex].scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                }
            }
            
            // 语音合成
            function speakCurrentLine() {
                if (!speechSynthesis) return;
                
                const transcriptLines = document.querySelectorAll('.transcript-line');
                if (transcriptLines[currentLineIndex]) {
                    const textElement = transcriptLines[currentLineIndex].querySelector('.text');
                    if (!textElement) return;
                    
                    const text = textElement.textContent;
                    speechSynthesis.cancel();
                    
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.rate = currentSpeed;
                    
                    // 尝试找到英语语音
                    const englishVoice = voices.find(voice => 
                        voice.lang.startsWith('en') && voice.name.includes('English'));
                    
                    if (englishVoice) {
                        utterance.voice = englishVoice;
                    }
                    
                    utterance.onstart = function() {
                        updateStatus("正在播放: " + text.substring(0, 20) + "...");
                    };
                    
                    utterance.onend = function() {
                        if (isLooping) {
                            speakCurrentLine();
                        } else if (isPlaying) {
                            // 播放下一个句子
                            const transcriptLines = document.querySelectorAll('.transcript-line');
                            if (currentLineIndex < transcriptLines.length - 1) {
                                currentLineIndex++;
                                highlightCurrentLine();
                                speakCurrentLine();
                            } else {
                                isPlaying = false;
                                playBtn.querySelector('i').classList.remove('fa-pause');
                                playBtn.querySelector('i').classList.add('fa-play');
                                updateStatus("播放完成");
                            }
                        }
                    };
                    
                    speechSynthesis.speak(utterance);
                }
            }
            
            // 复读功能
            repeatBtn.addEventListener('click', function() {
                if (!speechSynthesis) return;
                
                speechSynthesis.cancel();
                speakCurrentLine();
                updateStatus("复读当前句子");
            });
            
            // 上一句
            prevBtn.addEventListener('click', function() {
                const transcriptLines = document.querySelectorAll('.transcript-line');
                if (currentLineIndex > 0) {
                    currentLineIndex--;
                    highlightCurrentLine();
                    if (isPlaying) {
                        speakCurrentLine();
                    }
                    updateStatus("已切换到上一句");
                }
            });
            
            // 下一句
            nextBtn.addEventListener('click', function() {
                const transcriptLines = document.querySelectorAll('.transcript-line');
                if (currentLineIndex < transcriptLines.length - 1) {
                    currentLineIndex++;
                    highlightCurrentLine();
                    if (isPlaying) {
                        speakCurrentLine();
                    }
                    updateStatus("已切换到下一句");
                }
            });
            
            // 循环播放
            loopBtn.addEventListener('click', function() {
                isLooping = !isLooping;
                if (isLooping) {
                    this.classList.add('active');
                    updateStatus("循环播放已启用");
                } else {
                    this.classList.remove('active');
                    updateStatus("循环播放已禁用");
                }
            });
            
            // 更新状态
            function updateStatus(message) {
                statusText.textContent = message;
            }
            
            // 初始化
            function init() {
                bindTranscriptEvents();
                highlightCurrentLine();
                
                // 在微信中显示特定提示
                if (/MicroMessenger/i.test(navigator.userAgent)) {
                    compatibilityWarning.style.display = 'flex';
                    compatibilityWarning.innerHTML = `
                        <i class="fas fa-info-circle"></i>
                        <div>提示：微信内置浏览器可能不支持语音朗读功能。如需使用完整功能，请点击右上角在外部浏览器中打开。</div>
                    `;
                }
            }
            
            // 执行初始化
            init();
        });
    </script>
</body>
</html>
